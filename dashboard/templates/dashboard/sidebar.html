<!-- Brand -->
<a href="/dashboard/home/">
  <div class="brand">
    <i class="bi bi-credit-card-2-front"></i><span>ZPay</span>
  </div>
</a>




<nav class="sb-nav">

  <!-- =============== EASEBUZZ =============== -->
  <!-- EASEBUZZ MAIN BUTTON -->
  <button class="sb-btn" data-sb-toggle="#sb-easebuzz" aria-expanded="true" hx-get="/dashboard/easebuzz/"
    hx-target="#content" hx-push-url="true">
    <i class="bi bi-lightning-charge-fill"></i><span>Easebuzz</span>
    <i class="bi bi-chevron-right sb-arrow"></i>
  </button>



  <div id="sb-easebuzz" class="sb-sub sb-group open">
    <!-- Merchant -->
    <button class="sb-btn is-sub" data-sb-toggle="#sb-eb-merchant" aria-expanded="false">
      <i class="bi bi-person"></i><span>Merchant</span><i class="bi bi-chevron-right sb-arrow"></i>
    </button>
    <div id="sb-eb-merchant" class="sb-sub">
      <a class="sb-link" hx-get="/easebuzz/merchant/add/" hx-target="#content" hx-push-url="true"><i
          class="bi bi-person-plus"></i> Add Merchant</a>
      <a class="sb-link" hx-get="/easebuzz/merchant/view/" hx-target="#content" hx-push-url="true"><i
          class="bi bi-eye"></i> View Merchant</a>
      <a class="sb-link" hx-get="/easebuzz/merchant/stats/" hx-target="#content" hx-push-url="true"><i
          class="bi bi-graph-up"></i> All Merchant Stats</a>
      <a class="sb-link" hx-get="/easebuzz/merchant/service/" hx-target="#content" hx-push-url="true"><i
          class="bi bi-briefcase"></i> Merchant Service</a>
      <a class="sb-link" hx-get="/easebuzz/merchant/session/" hx-target="#content" hx-push-url="true"><i
          class="bi bi-laptop"></i> Active Session</a>
      <a class="sb-link" hx-get="/easebuzz/merchant/currency/" hx-target="#content" hx-push-url="true"><i
          class="bi bi-currency-dollar"></i> Active Currency</a>
      <a class="sb-link" hx-get="/easebuzz/merchant/bulksheets/" hx-target="#content" hx-push-url="true"><i
          class="bi bi-file-earmark-spreadsheet"></i> All Bulk Sheets</a>
    </div>

    <!-- Payout -->
    <button class="sb-btn is-sub" data-sb-toggle="#sb-eb-payout" aria-expanded="false">
      <i class="bi bi-credit-card"></i><span>Payout</span><i class="bi bi-chevron-right sb-arrow"></i>
    </button>
    <div id="sb-eb-payout" class="sb-sub sb-group">
      <a class="sb-link" hx-get="/easebuzz/payout/dashboard/" hx-target="#content" hx-push-url="true"><i
          class="bi bi-graph-up"></i> Dashboard</a>
      <a class="sb-link" hx-get="/easebuzz/payout/merchants/" hx-target="#content" hx-push-url="true"><i
          class="bi bi-people-fill"></i> Payout Merchants</a>
      <a class="sb-link" hx-get="/easebuzz/payout/callback/" hx-target="#content" hx-push-url="true"><i
          class="bi bi-arrow-repeat"></i> Callback Details</a>
      <a class="sb-link" hx-get="/easebuzz/payout/wallet/" hx-target="#content" hx-push-url="true"><i
          class="bi bi-wallet2"></i> Wallet Requests</a>
      <a class="sb-link" hx-get="/easebuzz/payout/ticket/" hx-target="#content" hx-push-url="true"><i
          class="bi bi-ticket-detailed"></i> Ticket Status</a>
      <a class="sb-link" hx-get="/easebuzz/payout/currency/" hx-target="#content" hx-push-url="true"><i
          class="bi bi-currency-dollar"></i> Currency</a>

      <!-- Payout → Transaction -->
      <button class="sb-btn is-sub" data-sb-toggle="#sb-eb-payout-txn" aria-expanded="false">
        <span>Transaction</span><i class="bi bi-chevron-right sb-arrow"></i>
      </button>
      <div id="sb-eb-payout-txn" class="sb-sub">
        <a class="sb-link" hx-get="/easebuzz/payout/payout_transaction/" hx-target="#content" hx-push-url="true"><i
            class="bi bi-cash"></i> Payout Txn</a>
        <a class="sb-link" hx-get="/easebuzz/payout/payout_transaction_request_history/" hx-target="#content"
          hx-push-url="true"><i class="bi bi-clock-history"></i> Request History</a>
        <a class="sb-link" hx-get="/easebuzz/payout/payout_transaction_virtual/" hx-target="#content"
          hx-push-url="true"><i class="bi bi-cash-stack"></i> Virtual Txn</a>
        <a class="sb-link" hx-get="/easebuzz/payout/payout_transaction_acquirer_report/" hx-target="#content"
          hx-push-url="true"><i class="bi bi-file-earmark-bar-graph"></i> Acquirer Report</a>
      </div>


      <!-- Payout → Master Service -->
      <button class="sb-btn is-sub" data-sb-toggle="#sb-eb-payout-master" aria-expanded="false">
        <span>Master Service</span><i class="bi bi-chevron-right sb-arrow"></i>
      </button>
      <div id="sb-eb-payout-master" class="sb-sub">
        <a class="sb-link" hx-get="/easebuzz/payout/payout_master_add_account/" hx-target="#content"
          hx-push-url="true"><i class="bi bi-person-plus"></i> Add Account</a>
        <a class="sb-link" hx-get="/easebuzz/payout/payout_master_activate_account/" hx-target="#content"
          hx-push-url="true"><i class="bi bi-bank"></i> Activate Account</a>
        <a class="sb-link" hx-get="/easebuzz/payout/payout_master_bank_statements/" hx-target="#content"
          hx-push-url="true"><i class="bi bi-bank2"></i> Download Bank Statements</a>
        <a class="sb-link" hx-get="/easebuzz/payout/payout_master_balance_list/" hx-target="#content"
          hx-push-url="true"><i class="bi bi-list-check"></i> Bank Bal. List</a>
      </div>

      <!-- Payout → Bulk Activities -->
      <button class="sb-btn is-sub" data-sb-toggle="#sb-eb-payout-bulk" aria-expanded="false">
        <span>Bulk Activities</span><i class="bi bi-chevron-right sb-arrow"></i>
      </button>
      <div id="sb-eb-payout-bulk" class="sb-sub">
        <a class="sb-link" hx-get="/easebuzz/payout/payout_bulk_update/" hx-target="#content" hx-push-url="true"><i
            class="bi bi-arrow-repeat"></i> Bulk Update</a>
        <!-- <a class="sb-link" hx-get="/easebuzz/payout/payout_bulk_txn_data/" hx-target="#content" hx-push-url="true"><i class="bi bi-database"></i> Txn Data</a> -->
      </div>
    </div>

    <!-- Payin -->
    <button class="sb-btn is-sub" data-sb-toggle="#sb-eb-payin" aria-expanded="false">
      <i class="bi bi-credit-card"></i><span>Payin</span><i class="bi bi-chevron-right sb-arrow"></i>
    </button>
    <div id="sb-eb-payin" class="sb-sub sb-group">
      <a class="sb-link" hx-get="/easebuzz/payin/dashboard/" hx-target="#content" hx-push-url="true"><i
          class="bi bi-graph-up"></i> Dashboard</a>
      <!-- <a class="sb-link" hx-get="/easebuzz/payin/method/" hx-target="#content" hx-push-url="true"><i class="bi bi-grid-3x3-gap"></i> Payin Method</a> -->
      <a class="sb-link" hx-get="/easebuzz/payin/merchants/" hx-target="#content" hx-push-url="true"><i
          class="bi bi-people-fill"></i> Payin Merchants</a>
      <a class="sb-link" hx-get="/easebuzz/payin/request/" hx-target="#content" hx-push-url="true"><i
          class="bi bi-list-check"></i> Payin Request</a>
      <!-- <a class="sb-link" hx-get="/easebuzz/payin/routing/" hx-target="#content" hx-push-url="true"><i class="bi bi-gear"></i> Test Routing</a> -->
      <a class="sb-link" hx-get="/easebuzz/payin/ticket/" hx-target="#content" hx-push-url="true"><i
          class="bi bi-ticket-detailed"></i> Ticket Status</a>
      <a class="sb-link" hx-get="/easebuzz/payin/currency/" hx-target="#content" hx-push-url="true"><i
          class="bi bi-currency-dollar"></i> Currency</a>
      <a class="sb-link" hx-get="/easebuzz/payin/callback_details/" hx-target="#content" hx-push-url="true"><i
          class="bi bi-envelope"></i> Callback Details</a>
      <!-- <a class="sb-link" hx-get="/easebuzz/payin/callback_gen/" hx-target="#content" hx-push-url="true"><i class="bi bi-envelope-open"></i> Callback Gen.</a> -->

      <!-- Payin → Transaction -->
      <button class="sb-btn is-sub" data-sb-toggle="#sb-eb-payin-txn" aria-expanded="false">
        <span>Transaction</span><i class="bi bi-chevron-right sb-arrow"></i>
      </button>
      <div id="sb-eb-payin-txn" class="sb-sub">
        <a class="sb-link" hx-get="/easebuzz/payin/payin_transaction/" hx-target="#content" hx-push-url="true"><i
            class="bi bi-cash"></i> Payin Txn</a>
        <a class="sb-link" hx-get="/easebuzz/payin/payin_transaction_dispute/" hx-target="#content"
          hx-push-url="true"><i class="bi bi-x-circle"></i> Dispute Txn</a>
        <a class="sb-link" hx-get="/easebuzz/payin/payin_transaction_chargeback/" hx-target="#content"
          hx-push-url="true"><i class="bi bi-arrow-counterclockwise"></i> ChargeBack Txn</a>
        <a class="sb-link" hx-get="/easebuzz/payin/payin_transaction_flag/" hx-target="#content" hx-push-url="true"><i
            class="bi bi-flag"></i> Flag Txn</a>
        <a class="sb-link" hx-get="/easebuzz/payin/payin_transaction_virtual/" hx-target="#content"
          hx-push-url="true"><i class="bi bi-cash-stack"></i> Virtual Txn</a>
        <a class="sb-link" hx-get="/easebuzz/payin/payin_transaction_unmatched/" hx-target="#content"
          hx-push-url="true"><i class="bi bi-slash"></i> Unmatched Txn</a>
        <a class="sb-link" hx-get="/easebuzz/payin/payin_transaction_acquirer_report/" hx-target="#content"
          hx-push-url="true"><i class="bi bi-file-earmark-bar-graph"></i> Acquirer Report</a>
      </div>

      <!-- Payin → Fuse -->
      <!-- <button class="sb-btn is-sub" data-sb-toggle="#sb-eb-payin-fuse" aria-expanded="false">
    <span>Fuse</span><i class="bi bi-chevron-right sb-arrow"></i>
  </button>
  <div id="sb-eb-payin-fuse" class="sb-sub">
    <a class="sb-link" hx-get="/easebuzz/payin/payin_fuse_fraud_list/" hx-target="#content" hx-push-url="true"><i class="bi bi-list"></i> Fraud List</a>
    <a class="sb-link" hx-get="/easebuzz/payin/payin_fuse_fraud_upload/" hx-target="#content" hx-push-url="true"><i class="bi bi-database"></i> Fraud Upload</a>
  </div> -->

      <!-- Payin → Master Service -->
      <button class="sb-btn is-sub" data-sb-toggle="#sb-eb-payin-master" aria-expanded="false">
        <span>Master Service</span><i class="bi bi-chevron-right sb-arrow"></i>
      </button>
      <div id="sb-eb-payin-master" class="sb-sub">
        <a class="sb-link" hx-get="/easebuzz/payin/payin_master_add_mid/" hx-target="#content" hx-push-url="true"><i
            class="bi bi-bank"></i> Add Mid</a>
        <a class="sb-link" hx-get="/easebuzz/payin/payin_master_activate_mid/" hx-target="#content"
          hx-push-url="true"><i class="bi bi-check-circle"></i> Activate Mid</a>
        <!-- <a class="sb-link" hx-get="/easebuzz/payin/payin_master_upi_handler/" hx-target="#content" hx-push-url="true"><i class="bi bi-equal"></i> UPI Handler</a>
    <a class="sb-link" hx-get="/easebuzz/payin/payin_master_gateway/" hx-target="#content" hx-push-url="true"><i class="bi bi-columns-gap"></i> Payin v Gateway</a> -->
      </div>

      <!-- Payin → Bulk Activities -->
      <!-- <button class="sb-btn is-sub" data-sb-toggle="#sb-eb-payin-bulk" aria-expanded="false">
    <span>Bulk Activities</span><i class="bi bi-chevron-right sb-arrow"></i>
  </button>
  <div id="sb-eb-payin-bulk" class="sb-sub">
    <a class="sb-link" hx-get="/easebuzz/payin/payin_bulk_dispute/" hx-target="#content" hx-push-url="true"><i class="bi bi-pencil-square"></i> Bulk Dispute Txn</a>
    <a class="sb-link" hx-get="/easebuzz/payin/payin_bulk_update/" hx-target="#content" hx-push-url="true"><i class="bi bi-pencil-square"></i> Bulk Update Txn</a>
    <a class="sb-link" hx-get="/easebuzz/payin/payin_bulk_chargeback/" hx-target="#content" hx-push-url="true"><i class="bi bi-pencil-square"></i> Bulk Chargeback</a>
    <a class="sb-link" hx-get="/easebuzz/payin/payin_bulk_bank_txn/" hx-target="#content" hx-push-url="true"><i class="bi bi-bank"></i> Get Bank Txn</a>
    <a class="sb-link" hx-get="/easebuzz/payin/payin_bulk_get_request/" hx-target="#content" hx-push-url="true"><i class="bi bi-clipboard-check"></i> Get Payin Request</a>
    <a class="sb-link" hx-get="/easebuzz/payin/payin_bulk_resend_callback/" hx-target="#content" hx-push-url="true"><i class="bi bi-envelope"></i> Resend Callback</a>
    <a class="sb-link" hx-get="/easebuzz/payin/payin_bulk_resend_bank_callback/" hx-target="#content" hx-push-url="true"><i class="bi bi-arrow-right"></i> Resend Bank Callback</a>
  </div> -->
    </div>


    <!-- Product -->
    <button class="sb-btn is-sub" data-sb-toggle="#sb-eb-product" aria-expanded="false">
      <i class="bi bi-box"></i><span>Product</span><i class="bi bi-chevron-right sb-arrow"></i>
    </button>
    <div id="sb-eb-product" class="sb-sub">
      <a class="sb-link" hx-get="/easebuzz/product/edit/" hx-target="#content" hx-push-url="true"><i
          class="bi bi-pencil-square"></i> Edit Product</a>
      <a class="sb-link" hx-get="/easebuzz/product/query/" hx-target="#content" hx-push-url="true"><i
          class="bi bi-search"></i> Query</a>
      <a class="sb-link" hx-get="/easebuzz/product/transaction/" hx-target="#content" hx-push-url="true"><i
          class="bi bi-cash"></i> Transaction</a>
    </div>
  </div>

  <!-- =============== RAZORPAY (placeholder) =============== -->
  <button class="sb-btn" data-sb-toggle="#sb-razorpay" aria-expanded="false">
    <i class="bi bi-lightning"></i><span>Razorpay</span><i class="bi bi-chevron-right sb-arrow"></i>
  </button>
  <!-- <div id="sb-razorpay" class="sb-sub">
    <a class="sb-link" hx-get="/easebuzz/product/transaction/" hx-target="#content" hx-push-url="true"><i class="bi bi-speedometer2"></i> Dashboard</a>
    <a class="sb-link" hx-get="/easebuzz/product/transaction/" hx-target="#content" hx-push-url="true"><i class="bi bi-people"></i> Merchants</a>
    <a class="sb-link" hx-get="/easebuzz/product/transaction/" hx-target="#content" hx-push-url="true"><i class="bi bi-cash-stack"></i> Transactions</a>
  </div> -->

  <!-- =============== PAYU (placeholder) =============== -->
  <button class="sb-btn" data-sb-toggle="#sb-payu" aria-expanded="false">
    <i class="bi bi-credit-card-2-front"></i><span>PayU</span><i class="bi bi-chevron-right sb-arrow"></i>
  </button>

  <!-- This should be added to your sidebar template -->
  <!-- Find the section where menu items are listed and add this chat menu item -->

  <style>
    .unread-badge {
      position: absolute;
      top: 8px;
      right: 12px;
      background: #ff4444;
      color: white;
      border-radius: 10px;
      padding: 2px 8px;
      font-size: 0.7rem;
      font-weight: 600;
      animation: pulse 2s infinite;
    }

    @keyframes pulse {

      0%,
      100% {
        opacity: 1;
      }

      50% {
        opacity: 0.7;
      }
    }
  </style>

  <!-- CHAT SECTION -->
  <div class="sidebar-section mt-3">
    <small class="text-muted px-3"
      style="font-size: 0.75rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px;">
      Communication
    </small>
    <div class="nav flex-column mt-2">
      <a class="sb-link {% if request.path == '/dashboard/chat/' %}active{% endif %}" href="/dashboard/chat/"
        style="position: relative;">
        <i class="bi bi-chat-dots-fill"></i>
        <span>Merchant Chat</span>
        {% if unread_messages_count > 0 %}
        <span class="unread-badge"
          style="position: absolute; right: 10px; background: #ff4444; color: white; border-radius: 10px; padding: 2px 8px; font-size: 0.7rem; font-weight: 600;">{{
          unread_messages_count }}</span>
        {% endif %}
      </a>
    </div>
  </div>

  <script>
    // Optional: Add this script to periodically check for new messages
    // This creates a simple polling mechanism (not real-time, but functional)
    function checkNewMessages() {
      fetch('/api/chat/unread-count/')
        .then(response => response.json())
        .then(data => {
          const badge = document.querySelector('.unread-badge');
          if (data.count > 0) {
            if (badge) {
              badge.textContent = data.count;
            } else {
              // Create badge if it doesn't exist
              const chatLink = document.querySelector('[href="/dashboard/chat/"]');
              if (chatLink) {
                const newBadge = document.createElement('span');
                newBadge.className = 'unread-badge';
                newBadge.textContent = data.count;
                chatLink.appendChild(newBadge);
              }
            }
          } else {
            if (badge) {
              badge.remove();
            }
          }
        })
        .catch(error => console.error('Error checking messages:', error));
    }

    // Check every 30 seconds
    setInterval(checkNewMessages, 30000);
  </script>
  <!-- <div id="sb-payu" class="sb-sub">
    <a class="sb-link" hx-get="/easebuzz/product/transaction/" hx-target="#content" hx-push-url="true"><i class="bi bi-speedometer2"></i> Dashboard</a>
    <a class="sb-link" hx-get="/easebuzz/product/transaction/" hx-target="#content" hx-push-url="true"><i class="bi bi-people"></i> Merchants</a>
    <a class="sb-link" hx-get="/easebuzz/product/transaction/" hx-target="#content" hx-push-url="true"><i class="bi bi-cash-stack"></i> Transactions</a>
  </div> -->

</nav>

<footer class="sb-footer">© 2025 ZPay</footer>